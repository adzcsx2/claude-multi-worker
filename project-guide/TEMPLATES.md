# Vibe Coding 文档模板

> Memory Bank 文档模板和进度管理

---

## 📋 目录

- [Memory Bank 文档模板](#memory-bank-文档模板)
- [进度状态管理](#进度状态管理critical)
- [Git 提交与回滚](#git-提交与回滚)

---

## 📄 Memory Bank 文档模板

### 01-tech-stack.md（技术栈）

```markdown
# 技术栈选型

## 项目信息
- **项目名称**: {项目名称}
- **项目类型**: {Android/Web/后端/等}
- **创建日期**: {日期}

## 技术选型

### 前端/客户端
- 框架: {框架名称}
- 状态管理: {方案}
- UI 库: {库}

### 后端
- 语言: {语言}
- 框架: {框架}
- 数据库: {数据库}

### 工具/库
- 测试: {测试框架}
- 构建: {构建工具}
- 其他: {其他工具}

## 架构模式
- {架构模式，如 MVVM/Clean Architecture/等}
```

### 02-product-requirements.md（产品需求）

```markdown
# 产品需求文档 (PRD)

## 项目概述
{项目描述}

## 核心功能

### 功能 1: {功能名称}
**描述**: {功能描述}
**优先级**: 高/中/低
**验收标准**:
- {标准 1}
- {标准 2}

### 功能 2: {功能名称}
...

## 非功能需求
- 性能: {性能要求}
- 安全: {安全要求}
- 兼容性: {兼容性要求}
```

### 03-implementation-plan.md（实施计划）

```markdown
# 实施计划

## 阶段划分

### 阶段 1: 基础设施
- [ ] **Step 1**: {任务描述}
  - 子任务 1
  - 子任务 2
  - **验收**: {验收标准}

- [ ] **Step 2**: {任务描述}
  ...

### 阶段 2: 核心功能
- [ ] **Step X**: {任务描述}
  ...

### 阶段 3: 高级功能
- [ ] **Step Y**: {任务描述}
  ...
```

### 04-architecture.md（架构文档）

```markdown
# 架构文档

## 项目结构

```
{项目根目录}/
├── src/
│   ├── main/
│   │   ├── java/       # 或其他语言目录
│   │   └── res/
│   └── test/
├── build.gradle
└── ...
```

## 文件说明

### 目录/文件用途
| 路径 | 用途 |
|-----|------|
| `src/main/java/...` | {说明} |

## 数据模型
### {实体名称}
| 字段 | 类型 | 说明 |
|-----|------|------|
| {字段名} | {类型} | {说明} |

## 依赖关系
- {模块 A} → {模块 B}
```

### 05-progress.md（进度跟踪）

```markdown
# 开发进度

## 项目信息
- **开始日期**: {日期}
- **当前阶段**: {阶段名称}
- **当前步骤**: Step X - {步骤名称}

## 进度总览
- **已完成**: {X}/{Y} 步骤 ({百分比}%)

## 详细进度

### ✅ 已完成
- [x] **Step 1**: {任务名称} - {完成日期}

### 🔄 进行中
- [ ] **Step 2**: {任务名称} - 开始日期: {日期}

### ⏳ 待开始
- [ ] **Step 3**: {任务名称}
- [ ] **Step 4**: {任务名称}

## 变更记录
| 日期 | 变更内容 |
|-----|---------|
| {日期} | {变更描述} |
```

### 06-ui-design.md（UI 设计规范）

```markdown
# UI 设计规范

> 本文档由设计任务窗口负责维护

## /ui 文件夹结构

```
/ui/
├── screen-001/
│   ├── screen.png    # UI 设计图（PNG）
│   └── code.html     # HTML 实现参考
├── screen-002/
│   ├── screen.png
│   └── code.html
└── ...
```

## 界面清单

| 界面名称 | 设计图 | HTML | 实现状态 |
|---------|--------|------|---------|
| {界面名称} | ✅ | ✅ | ⏳ 待实现 |
| {界面名称} | ✅ | ❌ | ⏳ 待实现 |

## 设计说明

{整体设计风格说明}

---

## 界面 1: {界面名称}

### 设计图
- 文件: `/ui/screen-001/screen.png`

### HTML 参考实现
- 文件: `/ui/screen-001/code.html`

### 提取的设计元素
- 布局: {布局描述}
- 颜色: {颜色方案}
- 组件: {使用的组件}

### Android/iOS/Web 实现要点
- {实现要点 1}
- {实现要点 2}

---

*本文档遵循 Vibe Coding 方法论 V1.2.2*
```

### 07-design-system.md（设计系统规范）

```markdown
# UI 设计规范

> 本文档由设计任务窗口负责维护

## 设计系统概述

### 设计原则
- **一致性优先**: 当 AI 生成的 UI 图不一致时，以设计系统为准
- **组件化**: 所有界面基于统一组件库构建
- **响应式**: 适配不同屏幕尺寸

---

## 🎨 颜色系统

### 主色调
| 颜色名称 | HEX | RGB | 用途 |
|---------|-----|-----|------|
| Primary | {主色} | rgb() | 主要操作、强调元素 |
| Secondary | {辅色} | rgb() | 次要操作、补充元素 |

### 中性色
| 颜色名称 | HEX | RGB | 用途 |
|---------|-----|-----|------|
| Background | {背景色} | rgb() | 页面背景 |
| Surface | {表面色} | rgb() | 卡片、对话框背景 |
| Text Primary | {主文字色} | rgb() | 主要文字 |
| Text Secondary | {次文字色} | rgb() | 次要文字 |
| Border | {边框色} | rgb() | 边框、分割线 |

### 语义色
| 颜色名称 | HEX | RGB | 用途 |
|---------|-----|-----|------|
| Success | {成功色} | rgb() | 成功状态、确认操作 |
| Warning | {警告色} | rgb() | 警告状态 |
| Error | {错误色} | rgb() | 错误状态、危险操作 |
| Info | {信息色} | rgb() | 信息提示 |

---

## 📝 字体系统

### 字体家族
- **Android**: {字体名称}
- **iOS**: {字体名称}
- **Web**: {字体栈}

### 字号规范
| 用途 | 字号 | 字重 | 行高 |
|-----|------|------|------|
| 大标题 | {字号} | {字重} | {行高} |
| 中标题 | {字号} | {字重} | {行高} |
| 小标题 | {字号} | {字重} | {行高} |
| 正文 | {字号} | {字重} | {行高} |
| 辅助文字 | {字号} | {字重} | {行高} |

---

## 🧩 组件规范

### 按钮（Button）
```
类型: Primary / Secondary / Outline / Text
尺寸: Large / Medium / Small
圆角: {dp}px
内边距: {dp}px
图标: {图标库} / {尺寸}
```

**Primary 按钮**:
- 背景色: Primary
- 文字色: {对比色}
- 高度: {dp}dp
- 圆角: {dp}dp

### 输入框（Input）
```
高度: {dp}dp
圆角: {dp}dp
边框: {dp}px {边框色}
内边距: {dp}px
焦点状态: {样式}
错误状态: {样式}
```

### 卡片（Card）
```
背景色: Surface
圆角: {dp}dp
阴影: {阴影值}
内边距: {dp}px
```

### 导航栏（NavigationBar）
```
高度: {dp}dp
背景色: {颜色}
文字色: {颜色}
图标尺寸: {dp}dp
```

---

## 📐 间距系统

### 基础间距单位
- **1 单位 = {dp}dp / {px}px**

### 间距等级
| 等级 | 值 | 用途 |
|-----|---|------|
| xs | {值} | 元素内部紧凑间距 |
| sm | {值} | 相关元素间间距 |
| md | {值} | 一般间距 |
| lg | {值} | 较大间距 |
| xl | {值} | 很大间距 |

### 常用间距
- 组件内边距: {值}
- 组件间垂直间距: {值}
- 组件间水平间距: {值}
- 页面边距: {值}

---

## 🎭 图标系统

### 图标库
- **Android**: {图标库名称}
- **iOS**: {图标库名称}
- **Web**: {图标库名称}

### 图标尺寸
| 用途 | 尺寸 |
|-----|------|
| 小图标 | {dp}dp |
| 中图标 | {dp}dp |
| 大图标 | {dp}dp |
| 导航图标 | {dp}dp |

---

## 🔲 圆角和阴影

### 圆角规范
| 元素 | 圆角值 |
|-----|--------|
| 按钮 | {dp}dp |
| 输入框 | {dp}dp |
| 卡片 | {dp}dp |
| 对话框 | {dp}dp |
| 头像 | {dp}dp |

### 阴影规范
| 等级 | 阴影值 | 用途 |
|-----|--------|------|
| sm | {值} | 轻微浮起 |
| md | {值} | 一般浮起 |
| lg | {值} | 明显浮起 |

---

## 📱 布局规范

### 页面结构
```
┌─────────────────────────────────────┐
│  导航栏 (NavigationBar)              │  高度: {dp}dp
├─────────────────────────────────────┤
│                                     │
│  内容区域 (Content)                  │  可滚动
│  - 页面边距: {dp}dp                  │
│  - 组件间距: {dp}dp                  │
│                                     │
├─────────────────────────────────────┤
│  底部导航 (BottomNav) / TabBar      │  高度: {dp}dp
└─────────────────────────────────────┘
```

### 列表规范
- 行高: {dp}dp
- 分割线: {样式}
- 内边距: {值}

---

## 🎬 动画规范

### 过渡时长
| 类型 | 时长 |
|-----|------|
| 快速 | {ms}ms |
| 标准 | {ms}ms |
| 缓慢 | {ms}ms |

### 缓动函数
- 进入: {缓动函数}
- 退出: {缓动函数}

---

## 📋 已实现界面清单

### 有 UI 设计图的界面
| 界面名称 | 文件路径 | 统一状态 | 备注 |
|---------|---------|---------|------|
| {界面名称} | /ui/{文件名}.png | ✅ 已统一 | |
| {界面名称} | /ui/{文件名}.png | ⚠️ 待统一 | 需调整 |

### 缺失 UI 设计图的界面
| 界面名称 | 设计状态 | 实现状态 |
|---------|---------|---------|
| {界面名称} | ✅ 已设计 | ✅ 已实现 |
| {界面名称} | 🔄 设计中 | ⏳ 待实现 |

---

## 🔧 设计工具

### AI 生成的 UI 图处理流程
1. **分析**: 提取所有 /ui/* 中的设计图
2. **对比**: 找出共同元素和冲突点
3. **决策**: 以设计系统为准，统一风格
4. **验证**: 确保所有界面遵循设计系统

### 缺失界面的设计流程
1. **需求**: 从 02-product-requirements.md 获取界面功能需求
2. **参考**: 参考已有界面的布局和组件
3. **设计**: 基于 07-design-system.md 设计新界面
4. **实现**: 生成符合设计系统的代码

---

*本文档由设计任务窗口维护，所有界面开发必须遵循此设计系统*
```

---

## 📊 进度状态管理（CRITICAL）

### 状态转换规则

```
⏳ 待开始 → 🔄 进行中 → ✅ 已完成
```

### AI 必须执行的操作

**开始一个步骤时：**
1. 将步骤从 `⏳ 待开始` 移到 `🔄 进行中`
2. 更新 `当前步骤` 字段

**完成一个步骤时（完全自动化，严格执行）：**
1. **编译项目**（确保代码没有语法错误）
2. **自动生成并运行测试（Android必须全部通过才能继续）**
   - 【所有项目】检查并创建 test/ 文件夹结构
   - 【Android】单元测试:
     * 检查测试目录是否存在，不存在则自动创建并编写测试
     * 运行: ./gradlew testDebugUnitTest
     * 测试报告保存到 test/reports/unit/
     * 失败则自动修复并重测
     * **必须通过才能继续**
   - 【Android】UI模拟测试（通过adb控制模拟器，完全自动化）:
     * 检查adb连接，无设备则自动选择/创建/启动模拟器
     * 启动应用并验证主界面加载
     * 通过adb模拟用户操作：点击、滑动、输入文本等
     * 执行关键用户流程的端到端测试
     * 截图保存到 test/screenshots/ui-simulation/
     * 操作日志保存到 test/logs/ui-simulation/
     * 测试报告保存到 test/reports/ui-simulation/
     * 自动检测UI响应、界面卡顿、操作失败、crash、ANR等问题
     * 失败则自动修复并重测
     * **必须通过才能继续**
   - 【Web】npm test
     * 测试报告保存到 test/reports/unit/
     * 覆盖率报告保存到 test/reports/coverage/
   - 所有测试必须通过，失败则自动修复并重测
3. ⚠️ 如果编译失败 → **自动修复问题并重新编译，编译失败绝对不允许跳过，绝对不允许进行下一步**
4. 如果测试失败 → 自动修复问题并重新执行步骤 1-3
5. 编译和测试全部通过后，**自动将**步骤从 `🔄 进行中` 移到 `✅ 已完成`（无需用户确认）
6. 添加完成日期
7. 将下一个步骤从 `⏳ 待开始` 移到 `🔄 进行中`
8. 更新 `当前步骤` 字段
9. 更新 `已完成` 计数

### 示例：Step 1 完成后的更新

```markdown
# 更新前
### 🔄 进行中
- [ ] **Step 1**: 项目初始化

### ⏳ 待开始
- [ ] **Step 2**: 数据库设计
```

```markdown
# 更新后
### ✅ 已完成
- [x] **Step 1**: 项目初始化 - 2025-01-25

### 🔄 进行中
- [ ] **Step 2**: 数据库设计 - 开始日期: 2025-01-25

### ⏳ 待开始
- [ ] **Step 3**: API 框架
```

**重要**: 每次 Step 完成后，AI 必须立即更新 `05-progress.md`，然后才能执行 Git 提交。

---

## 📦 Git 提交与回滚

### 每个步骤完成后自动提交

```
代码完成 → 编译（必须通过）→ 自动生成测试 → 运行测试 → 失败则自动修复并重测 → 全部通过 → 自动更新文档 → git add . → git commit → 返回菜单
```

**重要（完全自动化）**：
- ⚠️ **编译是第一道关卡，编译失败绝对不允许进行下一步**
- 编译通过后，**所有测试**都通过后，**自动**更新文档和执行 Git 提交，无需用户确认
- 【Android】单元测试: 自动创建测试目录并自动编写测试代码，全部通过
- 【Android】UI测试: 自动检查adb连接并自动启动模拟器，自动编写UI测试代码，自动检测crash/ANR/UI错误
- 【Android】UI模拟测试: 通过adb控制模拟器模拟用户操作（点击、滑动、输入），执行端到端流程测试，全部通过
- 【Web】自动化测试: 所有单元测试、集成测试必须通过
- 测试失败则自动修复并重测，无需用户介入
- ⚠️ 如果编译失败 → 自动修复问题并重新编译，编译失败绝对不允许跳过，绝对不允许进行下一步
- 如果测试失败 → 自动修复问题并重新测试，不能跳过

每个提交都会创建一个**回滚节点**，如果出问题可以随时恢复。

### 查看提交历史

```bash
git log --oneline
```

输出示例：
```
abc1234 feat: step 6 - 添加个人资料页面
def5678 feat: step 5 - 实现登录功能
ghi9012 feat: step 4 - 创建用户模型
...
```

### 回滚到之前的状态

```bash
# 查看最近 5 次提交
git log --oneline -5

# 回滚到指定步骤（保留代码）
git reset --soft abc1234

# 完全回滚到指定步骤（丢弃之后的所有更改）
git reset --hard abc1234

# 回滚到上一个提交
git reset --hard HEAD~1
```

### 实际场景

```
场景：Step 7 改坏了代码，想回到 Step 6

1. 查看历史
   git log --oneline
   → abc1234 feat: step 6 - 添加个人资料页面
   → xyz7890 feat: step 7 - 添加消息通知  (坏了)

2. 回滚
   git reset --hard abc1234

3. 继续开发
   [告诉 AI：回滚到 step 6，请重新执行 step 7]
```

---

*本文档遵循 Vibe Coding 方法论 V1.2.2*
